# Florida Panther DB Folder

This folder contains all scripts, data, and SQL files for processing and importing Florida Panther telemetry and mortality data into Supabase/PostgreSQL.

## File Descriptions

### Data Files
- **Florida_Panther_Telemetry.csv**  
  Raw telemetry data (GPS tracking) for Florida panthers. Contains X/Y coordinates, UTM coordinates, timestamps, and panther IDs.

- **Florida_Panther_Mortality.csv**  
  Raw mortality event data for Florida panthers. Contains X/Y coordinates (Florida GDL Albers), location descriptions, cause of death, and panther IDs.

### Processing Scripts
- **process-panther-data.ps1**  
  PowerShell script that processes the raw CSVs and generates three import files:
  - `panther_import.csv`: Unique panther records for the `panther` table.
  - `mortality_import.csv`: Mortality events with latitude/longitude for the `mortality` table.
  - `telemetry_import.csv`: Telemetry points with latitude/longitude for the `telemetry` table.
  
  The script uses `convert_coordinates.py` to convert X/Y coordinates to WGS84 latitude/longitude.

- **convert_coordinates.py**  
  Python script that converts X/Y coordinates from NAD83(HARN) / Florida GDL Albers (EPSG:3087) to WGS84 latitude/longitude (EPSG:4326). Used by the PowerShell script for accurate geolocation.

### SQL Files
- **tables.sql**  
  SQL schema for creating the `panther`, `mortality`, and `telemetry` tables in Supabase/PostgreSQL. Includes indexes and comments.

- **rpc_functions_latlon.sql**  
  SQL file defining all RPC (remote procedure call) functions for querying panther, mortality, and telemetry data by location, time, sex, and cause. Used by the frontend for map and chart queries.

### Import Files (Generated by Script)
- **panther_import.csv**  
  Import file for the `panther` table. Contains unique panther IDs, sex, age, and age unit.

- **mortality_import.csv**  
  Import file for the `mortality` table. Contains panther ID, cause, location, year, date, latitude, and longitude.

- **telemetry_import.csv**  
  Import file for the `telemetry` table. Contains panther ID, latitude, longitude, date, and time for each telemetry point.

---

**Workflow:**
1. Place the latest raw CSVs in this folder.
2. Run `process-panther-data.ps1` to generate import files.
3. Import the generated CSVs into Supabase in this order: `panther_import.csv`, `mortality_import.csv`, `telemetry_import.csv`.
4. Use `tables.sql` and `rpc_functions_latlon.sql` to set up and update the database schema and functions.
